(this.webpackJsonpbandsos=this.webpackJsonpbandsos||[]).push([[0],{102:function(e,t,a){},107:function(e,t,a){},113:function(e,t,a){},115:function(e,t,a){},117:function(e,t,a){"use strict";a.r(t);var c=a(0),r=a.n(c),s=a(18),n=a.n(s),o=(a(102),a(75)),l=a(7),i=a(59),d=a.n(i),b=a(124),j=a(130),u=a(125),f=a(126),h=a(127),m=a(128),O=a(10),v=a.n(O),p=a(88),x=(a(105),a(1));var g=function(e){var t=Object(c.useRef)();return console.log(e),Object(c.useEffect)((function(){new p.a(t.current,e.url,{title:e.title,ylabel:"Water level (m)",xlabel:"Datetime",gridLineWidth:"0.1"})})),Object(x.jsx)("div",{ref:t})},y=a(21);a(107);var w=function(e){var t=Object(y.c)();return v.a.Control.Colorbar=v.a.Control.extend({onAdd:function(t){var a=v.a.DomUtil.create("div","colorbar-container");return v.a.DomUtil.create("img","colorbar",a).src=e.colorbar,a},onRemove:function(e){}}),v.a.control.colorbar=function(e){return new v.a.Control.Colorbar(e)},Object(c.useEffect)((function(){var a=t.layerContainer||t.map,c=v.a.control.colorbar({position:e.position});return a.addControl(c),function(){a.removeControl(c)}})),null},S=a.p+"static/media/level.610b15a1.svg",C=Object(O.icon)({iconUrl:S,iconSize:[24,24]});var I=function(e){var t=e.dataurl,a=e.config,r=e.forecast,s=e.timestep;console.log("From Map container",a,r,s);var n=t+"/"+r.cycle+"/"+r.forecasts.elev.src+"/"+r.forecasts.elev.layers[0].type+"/"+s.folder+"/{z}/{x}/{y}.png";console.log(n);var o=Object(c.useRef)(null);return Object(c.useEffect)((function(){o.current&&o.current.setUrl(n)}),[n]),Object(x.jsxs)(b.a,{center:a.center,bounds:Object(O.latLngBounds)(Object(O.latLng)(a.bounds.south,a.bounds.west),Object(O.latLng)(a.bounds.north,a.bounds.east)),zoom:a.zoom,scrollWheelZoom:!0,minZoom:a.minzoom,maxZoom:a.maxzoom,style:{width:"100vw",height:"100%"},children:[Object(x.jsx)(j.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zIndex:1}),r.forecasts.elev.layers[1].stations.map((function(e){return Object(x.jsx)(u.a,{position:[e.Lat,e.Lon],icon:C,children:Object(x.jsxs)(f.a,{maxWidth:"80%",children:[Object(x.jsxs)(h.a,{children:["Station ID: ",e.ID," ",Object(x.jsx)("br",{}),"Station Name: ",e.Name," ",Object(x.jsx)("br",{}),"Longitude: ",e.Lon," ",Object(x.jsx)("br",{}),"Latitude: ",e.Lat," ",Object(x.jsx)("br",{})]}),Object(x.jsx)(g,{url:t+"/"+r.cycle+"/"+r.forecasts.elev.src+"/"+r.forecasts.elev.layers[1].type+"/"+e.ID+".csv",title:e.Name+" - "+e.Organization})]})},e.ID)})),Object(x.jsx)(j.a,{url:n,tms:!0,opacity:1,zIndex:10,ref:o}),Object(x.jsx)(w,{position:"bottomright",colorbar:t+"/"+r.cycle+"/"+r.forecasts.elev.src+"/"+r.forecasts.elev.layers[0].type+"/colorbar.png"}),Object(x.jsx)(m.a,{position:"bottomleft",metric:!0,imperial:!0,maxWidth:200})]})},L=a(3),k=a(92),z=a(94),D=a(50),F=a(15),E=a(86),B=a(93),N=a(57);var T=function(e){var t=e.sitename,a=e.navbar,c=e.forecast,r=e.setForecast,s=e.cycles,n=function(e){var t=Object(L.a)({},c);switch(e.target.name){case"forecastdate":t.date=e.target.value,t.folder="".concat(e.target.value.replaceAll("-","")).concat(c.cycle);break;case"forecastcycle":t.cycle=e.target.value,t.folder="".concat(c.date.replaceAll("-","")).concat(e.target.value)}r(t)};return Object(x.jsx)(D.a,{bg:"light",expand:"lg",children:Object(x.jsxs)(k.a,{children:[Object(x.jsx)(D.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(x.jsx)(D.a.Brand,{href:"/",children:Object(x.jsx)("img",{alt:t,src:a.branding.icon,height:"35px"})}),Object(x.jsxs)(D.a.Collapse,{id:"basic-navbar-nav",children:[Object(x.jsx)(D.a.Brand,{href:"/",children:Object(x.jsx)("b",{children:"BandSOS"})}),Object(x.jsxs)(z.a,{className:"me-auto",children:[Object(x.jsx)(F.a,{title:"Data",children:Object(x.jsx)(F.a.Item,{href:"#",children:"Layers"})}),Object(x.jsxs)(F.a,{title:"About",children:[Object(x.jsx)(F.a.Item,{href:"https://www.spaceclimateobservatory.org/band-sos-bengal-delta",children:"Project"}),Object(x.jsx)(F.a.Item,{href:"https://github.com/bandsos/",children:"Website"}),Object(x.jsx)(F.a.Item,{href:"https://github.com/schism-dev/schism",children:"Model"}),Object(x.jsx)(F.a.Item,{href:"https://github.com/bandsos/status",children:"System Status"})]}),Object(x.jsxs)(F.a,{title:"Partners",children:[Object(x.jsx)(F.a.Item,{href:"https://www.bwdb.gov.bd",children:"BWDB"}),Object(x.jsx)(F.a.Item,{href:"https://ffwc.gov.bd",children:"FFWC"}),Object(x.jsx)(F.a.Divider,{}),Object(x.jsx)(F.a.Item,{href:"https://www.ird.fr",children:"IRD"}),Object(x.jsx)(F.a.Item,{href:"https://lienss.univ-lr.fr",children:"LIENSs"}),Object(x.jsx)(F.a.Item,{href:"https://www.legos.omp.eu/",children:"LEGOS"})]})]})]}),Object(x.jsxs)(B.a,{children:[Object(x.jsx)(N.a,{children:Object(x.jsx)(E.a.Control,{type:"date",name:"forecastdate",min:"2020-01-01",defaultValue:c.date,placeholder:"Forecast Date",onChange:n})}),Object(x.jsx)(N.a,{children:Object(x.jsx)(E.a.Select,{placeholder:"Cycle",name:"forecastcycle",onChange:n,children:s.map((function(e){return c.cycle===e?Object(x.jsxs)("option",{value:e,selected:!0,children:[e,"Z"]},e):Object(x.jsxs)("option",{value:e,children:[e,"Z"]},e)}))})})]})]})})},W=(a(113),function(e){var t=e.forecast,a=e.setTimestep;console.log("from timeslider",t);var r=t.forecasts.elev.layers[0].timestamps,s=0+r.length-1,n=r[0].time,o=r[s].time,i=Object(c.useState)(8),d=Object(l.a)(i,2),b=d[0],j=d[1];return Object(x.jsx)(k.a,{className:"timeslider-outer",children:Object(x.jsxs)("div",{className:"timeslider-parent",children:[Object(x.jsxs)("div",{id:"starttime",children:[Object(x.jsxs)("div",{children:[n.split(" ")[0]," "]}),Object(x.jsxs)("div",{children:[n.split(" ")[1].split(":")[0],"h UTC"]})]}),Object(x.jsxs)("div",{id:"timeslider",children:[Object(x.jsx)("input",{type:"range",id:"range",className:"slider",list:"values",min:0,max:s,value:b,onChange:function(e){var t=e.target.value;j(t),a({folder:r[t].folder})}}),Object(x.jsx)("output",{}),Object(x.jsx)("div",{class:"range-slider__progress"}),Object(x.jsxs)("div",{id:"buble",children:["Currently viewing: ",Object(x.jsx)("b",{children:r[b].time})]})]}),Object(x.jsxs)("div",{id:"endtime",children:[Object(x.jsxs)("div",{children:[o.split(" ")[0]," "]}),Object(x.jsxs)("div",{children:[o.split(" ")[1].split(":")[0],"h UTC"]})]})]})})}),P={sitename:"BandSOS",dataurl:"https://bandsos.github.io",map:{mapcenter:[22,90],bounds:{east:85,west:95,south:20,north:24},zoom:9,minzoom:6,maxzoom:10},navbar:{branding:{icon:a.p+"static/media/logo.3729d826.png"}},cycles:["00","06","12","18"],fallback_forecast:{date:"2022-10-01",cycle:"00"}},_=(a(114),a(115),a(129));function A(){console.log("Site config",P);var e=Object(c.useState)({available:!1,data:{}}),t=Object(l.a)(e,2),a=t[0],r=t[1];Object(c.useEffect)((function(){var e=P.dataurl+"/status/status.json";fetch(e).then(function(){var e=Object(o.a)(d.a.mark((function e(t){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(a=e.sent,t.ok){e.next=6;break}return c=a&&a.message||t.statusText,e.abrupt("return",Promise.reject(c));case 6:r({available:!0,data:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(t){r({errormessage:t.toString()}),console.error("Error loading manifest from ",e)}))}),[]),console.log("Platform status: ",a);var s=Object(c.useState)({downloaded:!1,date:P.fallback_forecast.date,cycle:P.fallback_forecast.cycle,dataurl:P.dataurl,folder:"".concat(P.fallback_forecast.date.replaceAll("-","")).concat(P.fallback_forecast.cycle)}),n=Object(l.a)(s,2),i=n[0],b=n[1];Object(c.useEffect)((function(){a.available&&b({downloaded:!0,date:a.data.lastforecast.date,cycle:a.data.lastforecast.cycle,dataurl:P.dataurl,folder:"".concat(a.data.lastforecast.date.replaceAll("-","")).concat(a.data.lastforecast.cycle)})}),[a]),console.log("Selected forecast",i);var j=Object(c.useState)({available:!1,payload:{}}),u=Object(l.a)(j,2),f=u[0],h=u[1];Object(c.useEffect)((function(){var e=i.dataurl+"/"+i.folder+"/manifest.json";fetch(e).then(function(){var e=Object(o.a)(d.a.mark((function e(t){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(a=e.sent,t.ok){e.next=6;break}return c=a&&a.message||t.statusText,e.abrupt("return",Promise.reject(c));case 6:h({available:!0,payload:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){h({errormessage:e.toString()}),console.error("Error loading manifest from ",i.url)}))}),[i]);var m=Object(c.useState)({folder:i.folder}),O=Object(l.a)(m,2),v=O[0],p=O[1];return Object(c.useEffect)((function(){p({folder:i.folder})}),[i]),Object(x.jsxs)("div",{id:"wrapper",children:[a.available?Object(x.jsx)("div",{id:"header",children:Object(x.jsx)(T,{sitename:P.sitename,navbar:P.navbar,forecast:i,setForecast:b,cycles:P.cycles})}):Object(x.jsx)("div",{id:"header",children:Object(x.jsx)(T,{sitename:P.sitename,navbar:P.navbar,forecast:{date:"",cycle:""},setForecast:b,cycles:P.cycles})}),f.available?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{id:"content",children:Object(x.jsx)(I,{dataurl:i.dataurl,config:P.map,forecast:f.payload,timestep:v})}),Object(x.jsx)(W,{forecast:f.payload,setTimestep:p})]}):Object(x.jsx)(k.a,{children:Object(x.jsxs)(_.a,{className:"",variant:"danger",children:["Forecast for ",i.date," cycle ",i.cycle," not available!"]},"danger")})]})}a(116);var U=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,131)).then((function(t){var a=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,n=t.getTTFB;a(e),c(e),r(e),s(e),n(e)}))};n.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(A,{})}),document.getElementById("root")),U()}},[[117,1,2]]]);
//# sourceMappingURL=main.db37535f.chunk.js.map